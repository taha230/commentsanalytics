{% extends "layouts/base_client.html" %}

{% block title %} Settings {% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-4">
        <div>
            <a id="startTourButton" class="btn btn btn-outline-success d-inline-flex align-items-center">
            
                <svg class="icon icon-xs me-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path></svg>
                Start Introductory Tour
            </a>
        </div>
        
    </div>
    <div class="">
        <div class="col-12 col-xl-12">
            <div class="card card-body border-0 shadow mb-4">
                <h2 class="h5 mb-4">Add New Bulk Request</h2>
                <form id='submit_form' method= "POST">
                    
                    {% csrf_token %}

                    <div class="row">
                        <div class="col-sm-3 mb-5">
                            <div class="form-group">
                                <label for="address">Title (<B style="color:red">*</B>)</label>
                                <input id="first-step-introjs-new-bulk" class="form-control" name="input_bulk_title" type="text" placeholder="Enter Title of Your Bulk here ..." required> <!-- required -->
                            </div>
                        </div>

                        <div class="col-sm-2 mb-3">
                            <label for="type">Type (<B style="color:red">*</B>)</label>
                            
                            

                                {% if requests_types|length == 1 %}
                                    <select class="form-select mb-0 " name="input_request_type" aria-label="Request Type" placeholder="Request Type" disabled>
                                        <option value="{{ row }}" selected> {{ requests_types.0 }}</option>
                                    </select>
                                    <textarea name="input_request_type" hidden> {{ requests_types.0 }}</textarea>

                                {% else %}
                                    <select class="form-select mb-0 " name="input_request_type" aria-label="Request Type" placeholder="Request Type" required> <!-- required -->
                                        <option value="" selected disabled hidden>Choose ...</option>
                                        {% for row in requests_types %}
                                            <option value="{{ row }}" >{{ row }}</option>
                                        {% endfor %}

                                    </select>
                                {% endif %}
                        </div>
                        <div class="col-sm-10 offset-sm-1 mb-6 ">
                            <a target="_blank" href="https://chrome.google.com/webstore/detail/commentsanalytics-comment/enafdhefaclokmhejcifkgiogmengdio">
                                <img class="card-img" src="/static/assets/img/illustrations/chrome banner_wide.svg" alt="chrome extension banner">
                            </a>
                        </div>
                    </div>

                    <div class="mb-2">
                        <label >Choose one of our input data methods :</label>
                    </div>
                    
                    <div id="second-step-introjs-new-bulk" class="row">

                        <!-- Json File -->
                        <div id="third-step-introjs-new-bulk" class="col-8 col-xxl-6 mb-1">
                            <div class="card_blue border-5">
                                <div class="mt-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="26" fill="blue" class="bi bi-filetype-json" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M14 4.5V11h-1V4.5h-2A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v9H2V2a2 2 0 0 1 2-2h5.5L14 4.5ZM4.151 15.29a1.176 1.176 0 0 1-.111-.449h.764a.578.578 0 0 0 .255.384c.07.049.154.087.25.114.095.028.201.041.319.041.164 0 .301-.023.413-.07a.559.559 0 0 0 .255-.193.507.507 0 0 0 .084-.29.387.387 0 0 0-.152-.326c-.101-.08-.256-.144-.463-.193l-.618-.143a1.72 1.72 0 0 1-.539-.214 1.001 1.001 0 0 1-.352-.367 1.068 1.068 0 0 1-.123-.524c0-.244.064-.457.19-.639.128-.181.304-.322.528-.422.225-.1.484-.149.777-.149.304 0 .564.05.779.152.217.102.384.239.5.41.12.17.186.359.2.566h-.75a.56.56 0 0 0-.12-.258.624.624 0 0 0-.246-.181.923.923 0 0 0-.37-.068c-.216 0-.387.05-.512.152a.472.472 0 0 0-.185.384c0 .121.048.22.144.3a.97.97 0 0 0 .404.175l.621.143c.217.05.406.12.566.211a1 1 0 0 1 .375.358c.09.148.135.335.135.56 0 .247-.063.466-.188.656a1.216 1.216 0 0 1-.539.439c-.234.105-.52.158-.858.158-.254 0-.476-.03-.665-.09a1.404 1.404 0 0 1-.478-.252 1.13 1.13 0 0 1-.29-.375Zm-3.104-.033a1.32 1.32 0 0 1-.082-.466h.764a.576.576 0 0 0 .074.27.499.499 0 0 0 .454.246c.19 0 .33-.055.422-.164.091-.11.137-.265.137-.466v-2.745h.791v2.725c0 .44-.119.774-.357 1.005-.237.23-.565.345-.985.345a1.59 1.59 0 0 1-.568-.094 1.145 1.145 0 0 1-.407-.266 1.14 1.14 0 0 1-.243-.39Zm9.091-1.585v.522c0 .256-.039.47-.117.641a.862.862 0 0 1-.322.387.877.877 0 0 1-.47.126.883.883 0 0 1-.47-.126.87.87 0 0 1-.32-.387 1.55 1.55 0 0 1-.117-.641v-.522c0-.258.039-.471.117-.641a.87.87 0 0 1 .32-.387.868.868 0 0 1 .47-.129c.177 0 .333.043.47.129a.862.862 0 0 1 .322.387c.078.17.117.383.117.641Zm.803.519v-.513c0-.377-.069-.701-.205-.973a1.46 1.46 0 0 0-.59-.63c-.253-.146-.559-.22-.916-.22-.356 0-.662.074-.92.22a1.441 1.441 0 0 0-.589.628c-.137.271-.205.596-.205.975v.513c0 .375.068.699.205.973.137.271.333.48.589.626.258.145.564.217.92.217.357 0 .663-.072.917-.217.256-.146.452-.355.589-.626.136-.274.205-.598.205-.973Zm1.29-.935v2.675h-.746v-3.999h.662l1.752 2.66h.032v-2.66h.75v4h-.656l-1.761-2.676h-.032Z"/>
                                    </svg>
                                    <h2 class="fs-5 fw-bold mb-0" style="color:blue" data-bs-toggle="tooltip" data-bs-placement="top" title='It is recommended to Download our Chrome Extension to Export your comments as a .json file and upload it here. Your .json file should contain a list of dicts of comments that the text of comment is in the "Msg" field. E.g. [{"Author":"Joma Adams","Msg":"I like this product"}]'>JSON Upload (.json)</h2>
                                </div>
                                
                                <div id="forth-step-introjs-new-bulk" class="file-field col-sm-4 mb-1 mt-6  dot-rectangle-blue">
                            
                                    <div class="d-flex">
                                        <svg class="icon text-gray-500 me-2 mb-7 mt-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 4a3 3 0 00-3 3v4a5 5 0 0010 0V7a1 1 0 112 0v4a7 7 0 11-14 0V7a5 5 0 0110 0v4a3 3 0 11-6 0V7a1 1 0 012 0v4a1 1 0 102 0V7a3 3 0 00-3-3z" clip-rule="evenodd"></path></svg>
                    
                                        <input type="file"
                                            name="json_file"
                                            id="json_file"
                                            style="border: 1px solid black; padding: 5px;"
                                            required="required">
                                        
                                                <div class="d-md-block">
                                                    <div class="fw-normal text-dark mb-1">Browse your JSON file (<B style="color:red">*</B>)</div>
                                                </div>

                                        
                                    </div>
                                </div>
  
                                <div class="mt-1 mb-2 text-xxl-center">
                                    <button id="fifth-step-introjs-new-bulk" class="btn btn-blue-800" type="submit" onclick="submit_upload_json()" >Preview the JSON data 
                                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-double-right" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M3.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L9.293 8 3.646 2.354a.5.5 0 0 1 0-.708z"/>
                                        <path fill-rule="evenodd" d="M7.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L13.293 8 7.646 2.354a.5.5 0 0 1 0-.708z"/>
                                      </svg>
                                     </button>
                                </div>

                            </div>
                        </div>
                         
                        <!-- Google SpreadSheet -->
                        <div class="col-8 col-xxl-6 mb-6">
                            <div class="card_orange border-5">
                                <div class="mt-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="26" fill="orange" class="bi bi-file-spreadsheet" viewBox="0 0 16 16">
                                        <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2zm2-1a1 1 0 0 0-1 1v4h10V2a1 1 0 0 0-1-1H4zm9 6h-3v2h3V7zm0 3h-3v2h3v-2zm0 3h-3v2h2a1 1 0 0 0 1-1v-1zm-4 2v-2H6v2h3zm-4 0v-2H3v1a1 1 0 0 0 1 1h1zm-2-3h2v-2H3v2zm0-3h2V7H3v2zm3-2v2h3V7H6zm3 3H6v2h3v-2z"/>
                                    </svg>
                                    <h2 class="fs-5 fw-bold mb-0 " style="color:orange">Google SpreadSheet</h2>
                                  </div>
                                <div class="card-body">
                                    <div class="row mb-5">
                                        <div class="col">
                                            
                                            <div class="col-sm-6 mb-2 ">
                                                <div class="form-group">
                                                    <label for="address" data-bs-toggle="tooltip" data-bs-placement="top" title="copy and paste your first row  of your desired column in spreadsheet here (Not A,B,...)" >Column Name (<B style="color:red">*</B>)</label>
                                                    <input class="form-control" name="column_name_spreadsheet" id="column_name_spreadsheet" type="text" placeholder="Enter Column Name of Your Comments here" required>
                                                </div>
                                            </div>

                                            <div class="col-sm-20 mb-2">
                                                <div class="form-group">
                                                    <label data-bs-toggle="tooltip" data-bs-placement="top" title="In order to share your google doc as spreadsheet, you should make it public on the web by clicking green top right share button and copy the sharing link on this field." for="address">SpreadSheet URL (<B style="color:red">*</B>)</label>
                                                    <input class="form-control" name="url_spreadsheet" id="url_spreadsheet" type="text" placeholder="Example : https://docs.google.com/spreadsheets/d/1UnfcyBQ...yl/edit?usp=sharing" required>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div class="mt-1 mb-2 text-xxl-center">
                                    <button class="btn btn-orange-800" type="submit" onclick="submit_google_spreadsheet()"  >Preview the spreadsheet data 
                                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-double-right" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M3.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L9.293 8 3.646 2.354a.5.5 0 0 1 0-.708z"/>
                                        <path fill-rule="evenodd" d="M7.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L13.293 8 7.646 2.354a.5.5 0 0 1 0-.708z"/>
                                      </svg>
                                     </button>
                                </div>
                            </div>
                        </div>


                        <!-- Excel Upload .xlsx  -->
                        <div class="col-8 col-xxl-6 mb-6">
                            <div class="card_green_light border-5">
                                <div class="mt-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="green" class="bi bi-file-earmark-excel-fill" viewBox="0 0 16 16">
                                        <path d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0zM9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1zM5.884 6.68 8 9.219l2.116-2.54a.5.5 0 1 1 .768.641L8.651 10l2.233 2.68a.5.5 0 0 1-.768.64L8 10.781l-2.116 2.54a.5.5 0 0 1-.768-.641L7.349 10 5.116 7.32a.5.5 0 1 1 .768-.64z"/>
                                      </svg>
                                      
                                    <h2 class="fs-5 fw-bold mb-0 " style="color:rgb(2, 102, 19)">Excel Upload (.xlsx)</h2>
                                  </div>
                                <div class="card-body">
                                    <div class="row mb-3">
                                        <div class="col">
                                            
                                            <div class="col-sm-6 mb-2 ">
                                                <div class="form-group">
                                                    <label data-bs-toggle="tooltip" data-bs-placement="top" title="First row of input .xlsx file is considered as title row and you should enter the name of your desired column in the first row" for="address">Column Name (<B style="color:red">*</B>)</label>
                                                    <input class="form-control" name="column_name_excel_xlsx" id="column_name_excel_xlsx" type="text" placeholder="Enter Column Name of Your Comments here" required>
                                                </div>
                                            </div>

                                            <div class="file-field col-sm-4 mb-1 dot-rectangle-green">
                            
                                                <div class="d-flex">
                                                    <svg class="icon text-gray-500 me-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 4a3 3 0 00-3 3v4a5 5 0 0010 0V7a1 1 0 112 0v4a7 7 0 11-14 0V7a5 5 0 0110 0v4a3 3 0 11-6 0V7a1 1 0 012 0v4a1 1 0 102 0V7a3 3 0 00-3-3z" clip-rule="evenodd"></path></svg>
                                
                                                    <input type="file"
                                                        name="excel_file_xlsx"
                                                        id="excel_file_xlsx"
                                                        style="border: 1px solid black; padding: 5px;"
                                                        required="required">

                                                    <div class="d-md-block">
                                                        <div class="fw-normal text-dark mb-1">Browse your Excel .xlsx file (<B style="color:red">*</B>)</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>        
                                    </div>

                                </div>
                                <div class="mt-3 mb-2 text-xxl-center">
                                    <button class="btn btn-green-800" type="submit" onclick="submit_upload_excel_xlsx()" >Preview the excel data 
                                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-double-right" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M3.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L9.293 8 3.646 2.354a.5.5 0 0 1 0-.708z"/>
                                        <path fill-rule="evenodd" d="M7.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L13.293 8 7.646 2.354a.5.5 0 0 1 0-.708z"/>
                                      </svg>
                                     </button>
                                </div>
                            </div>
                        </div>

                        <!-- Excel Upload .csv  -->
                        <div class="col-8 col-xxl-6 mb-6">
                            <div class="card_magenta border-5">
                                <div class="mt-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="green" class="bi bi-file-earmark-excel-fill" viewBox="0 0 16 16">
                                        <path d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0zM9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1zM5.884 6.68 8 9.219l2.116-2.54a.5.5 0 1 1 .768.641L8.651 10l2.233 2.68a.5.5 0 0 1-.768.64L8 10.781l-2.116 2.54a.5.5 0 0 1-.768-.641L7.349 10 5.116 7.32a.5.5 0 1 1 .768-.64z"/>
                                      </svg>
                                      
                                    <h2 class="fs-5 fw-bold mb-0 " style="color:rgb(2, 102, 19)">Excel Upload (.csv)</h2>
                                  </div>
                                <div class="card-body">
                                    <div class="row mb-3">
                                        <div class="col">
                                            
                                            <div class="row">
                                                <div class="col-sm-6 mb-2 ">
                                                    <div class="form-group">
                                                        <label data-bs-toggle="tooltip" data-bs-placement="top" title="First row of input .csv file is considered as title row and you should enter the name of your desired column in the first row" for="address">Column Name (<B style="color:red">*</B>)</label>
                                                        <input class="form-control" name="column_name_excel_csv" id="column_name_excel_csv" type="text" placeholder="Enter Column Name of Your Comments here" required>
                                                    </div>
                                                </div>

                                                <div class="col-sm-6 mb-2 ">
                                                    <div class="form-group">
                                                        <label data-bs-toggle="tooltip" data-bs-placement="top" title="Delimiter of .csv file is usually comma(,), but for variant types of delimiters it is mandatory to enter your delimiter in your excel file." for="address">Delimiter (<B style="color:red">*</B>)</label>
                                                        <input class="form-control" name="delimiter_excel_csv" id="delimiter_excel_csv" type="text" placeholder="Delimiter of Your Excel file. Example , ; : " required>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="file-field col-sm-4 mb-1 dot-rectangle-purple">
                            
                                                <div class="d-flex">
                                                    <svg class="icon text-gray-500 me-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8 4a3 3 0 00-3 3v4a5 5 0 0010 0V7a1 1 0 112 0v4a7 7 0 11-14 0V7a5 5 0 0110 0v4a3 3 0 11-6 0V7a1 1 0 012 0v4a1 1 0 102 0V7a3 3 0 00-3-3z" clip-rule="evenodd"></path></svg>
                                
                                                    <input type="file"
                                                        name="excel_file_csv"
                                                        id="excel_file_csv"
                                                        style="border: 1px solid black; padding: 5px;"
                                                        required="required">

                                                    <div class="d-md-block">
                                                        <div class="fw-normal text-dark mb-1">Browse your Excel .csv file (<B style="color:red">*</B>)</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>        
                                    </div>

                                </div>
                                <div class="mt-3 mb-1 text-xxl-center">
                                    <button class="btn btn-green-800" type="submit" onclick="submit_upload_excel_csv()" >Preview the excel data 
                                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-double-right" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M3.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L9.293 8 3.646 2.354a.5.5 0 0 1 0-.708z"/>
                                        <path fill-rule="evenodd" d="M7.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L13.293 8 7.646 2.354a.5.5 0 0 1 0-.708z"/>
                                      </svg>
                                     </button>
                                </div>
                            </div>
                        </div>


                    </div>

                       
                </form>
            </div>

        </div>
        
    </div>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
<script>

  function submit_google_spreadsheet() {
    
    document.getElementById('column_name_spreadsheet').required = true;
    document.getElementById('url_spreadsheet').required = true;
    document.getElementById('json_file').required = false;
    document.getElementById('column_name_excel_xlsx').required = false;
    document.getElementById('excel_file_xlsx').required = false;
    document.getElementById('column_name_excel_csv').required = false;
    document.getElementById('excel_file_csv').required = false;
    document.getElementById('delimiter_excel_csv').required = false;

    document.getElementById('submit_form').enctype="";
    document.getElementById('submit_form').action = "/requests_new_bulk_data_confirm/method_google_spreadsheet";

  }

  function submit_upload_json() {
    
    document.getElementById('json_file').required = true;
    document.getElementById('column_name_spreadsheet').required = false;
    document.getElementById('url_spreadsheet').required = false;
    document.getElementById('column_name_excel_xlsx').required = false;
    document.getElementById('excel_file_xlsx').required = false;
    document.getElementById('column_name_excel_csv').required = false;
    document.getElementById('excel_file_csv').required = false;
    document.getElementById('delimiter_excel_csv').required = false;

    document.getElementById('submit_form').enctype="multipart/form-data"; // added for uploading file and get in requests.FILES[]
    document.getElementById('submit_form').action = "/requests_new_bulk_data_confirm/method_json";

  }


  function submit_upload_excel_xlsx() {
    
    document.getElementById('column_name_excel_xlsx').required = true;
    document.getElementById('excel_file_xlsx').required = true;
    document.getElementById('json_file').required = false;
    document.getElementById('column_name_spreadsheet').required = false;
    document.getElementById('url_spreadsheet').required = false;
    document.getElementById('column_name_excel_csv').required = false;
    document.getElementById('excel_file_csv').required = false;
    document.getElementById('delimiter_excel_csv').required = false;

    document.getElementById('submit_form').enctype="multipart/form-data"; // added for uploading file and get in requests.FILES[]
    document.getElementById('submit_form').action = "/requests_new_bulk_data_confirm/method_excel";

  }

  function submit_upload_excel_csv() {
    
    document.getElementById('column_name_excel_csv').required = true;
    document.getElementById('excel_file_csv').required = true;
    document.getElementById('delimiter_excel_csv').required = true;
    document.getElementById('json_file').required = false;
    document.getElementById('column_name_spreadsheet').required = false;
    document.getElementById('url_spreadsheet').required = false;
    document.getElementById('column_name_excel_xlsx').required = false;
    document.getElementById('excel_file_xlsx').required = false;

    document.getElementById('submit_form').enctype="multipart/form-data"; // added for uploading file and get in requests.FILES[]
    document.getElementById('submit_form').action = "/requests_new_bulk_data_confirm/method_excel";

  }

</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/7.0.1/intro.min.js"></script>
<script src="/static/assets/js/client_new_bulk_introjs.js"> </script>

{% endblock javascripts %}
